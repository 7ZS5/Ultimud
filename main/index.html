<!DOCTYPE html>

<html lang="en">

<head>

<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Document</title>

<style>

* {

    padding: 0px;
    margin: 0px;
    box-sizing: border-box;
    color: rgb(0, 255, 0);

}

canvas {
    border: 1px solid #000000;
}

#main {

    padding: 10px;
    position: fixed;
    top: 0px;
    left: 0px;
    width: 100%;
    height: 100%;
    background-image: linear-gradient(grey, black);

}

#column1 {

    position: fixed;
    top: 20px;
    left: 650px;

}

#output {

    border: 1px solid black;
    width: 600px;
    height: 400px;
    overflow: auto;
    word-wrap: break-word;
    padding-left: 5px;
    padding-top: 5px;

}

#input {

    background-color: transparent;
    border: none;
    border: 1px solid black;
    width: 400px;
    outline: none;

}

#canvasFloor {
    position: fixed;
    top: 500px;
    left: 10px;
    background-color: black;
}

#canvasObjects {
    position: fixed;
    top: 500px;
    left: 10px;
}

#canvasPlayer {
    position: fixed;
    top: 500px;
    left: 10px;
}

.contColumn {

    display: flex;
    flex-direction: column;

}

.contRow {

    display: flex;
    flex-direction: row;

}

.outputMessage {

    background-color: darkblue;

}

.p1 {

    margin-left: 7px;

}

</style>

</head>

<body>

<div id="main">

<h1>Developer Environment</h1>

<div id="column1" class="contColumn">

    <div id="row1" class="contRow">

        <div class="contColumn" style="margin-left: 50px;">

            <div class="contRow">currentRoom:
                <p id="currentRoom" class="p1">none</p>
            </div>

            <div class="contRow">currentTarget:
                <p id="lastTarget" class="p1">none</p>
            </div>
            
        </div>

        <div class="contColumn" style="margin-left: 50px;">

            <div class="contRow">Name:
                <p id="name" class="p1">none</p>
            </div>

            <div class="contRow">Ancestry:
                <p id="ancestry" class="p1">none</p>
            </div>

            <div class="contRow">Job:
                <p id="job" class="p1">none</p>
            </div>

            <div class="contRow">Level:
                <p id="level" class="p1">1</p>
            </div>

            <div class="contRow">Exp:
                <p id="exp" class="p1">0</p>
            </div>

            <div class="contRow">Hp:
                <p id="hp" class="p1">100</p>
            </div>

            <div class="contRow">Mp:
                <p id="mp" class="p1">0</p>
            </div>

            <div class="contRow">Ep:
                <p id="ep" class="p1">0</p>
            </div>

            <div class="contRow">Fatigue:
                <p id="fatigue" class="p1">50</p>
            </div>
            
        </div>

        <div class="contColumn" style="margin-left: 50px;">Inventory:

            <p class="invItem">none</p>

        </div>

        <div class="contColumn" style="margin-left: 50px;">Skills:
    
            <p class="skill">none</p>

        </div>

        <div class="contColumn" style="margin-left: 50px;">Spells:

            <p class="spell">none</p>
        
        </div>

        <div class="contColumn" style="margin-left: 50px;">Equipment:

            <div class="contRow">Head:
                <p id="head" class="p1">none</p>
            </div>

            <div class="contRow">Torso:
                <p id="torso" class="p1">none</p>
            </div>

            <div class="contRow">Legs:
                <p id="legs" class="p1">none</p>
            </div>

            <div class="contRow">Hands:
                <p id="hands" class="p1">none</p>
            </div>

            <div class="contRow">Feet:
                <p id="feet" class="p1">none</p>
            </div>

        </div>

    </div>

    <div id="row2" class="contRow" style="margin-top: 50px;">

        <div class="contColumn" style="margin-left: 50px;">

            <div class="contRow">Weapon1:
                <p class="p1">none</p>
            </div>

            <div class="contRow">Weapon2:
                <p class="p1">none</p>
            </div>

            <div class="contRow">Weapon3:
                <p class="p1">none</p>
            </div>

            <div class="contRow">Weapon4:
                <p class="p1">none</p>
            </div>

            <div class="contRow">Ammo:
                <p class="p1">none</p>
            </div>

            <div class="contRow">Shield:
                <p class="p1">none</p>
            </div>

            <div class="contRow">ShieldBack:
                <p class="p1">none</p>
            </div>

        </div>

        <div class="contColumn" style="margin-left: 50px;">

            <div class="contRow">bodyType:
                <p class="p1">none</p>
            </div>

            <div class="contRow">Height:
                <p class="p1">none</p>
            </div>

            <div class="contRow">hairStyle:
                <p class="p1">none</p>
            </div>

            <div class="contRow">facialHairStyle:
                <p class="p1">none</p>
            </div>

            <div class="contRow">hairColor:
                <p class="p1">none</p>
            </div>

            <div class="contRow">eyeColor:
                <p class="p1">none</p>
            </div>

        </div>

    </div>

</div>

<canvas id="canvasFloor"></canvas>
<canvas id="canvasObjects"></canvas>
<canvas id="canvasPlayer"></canvas>

<div id="output"></div>

<input id="input" type="text">

</div>

<script>

/* LEGEND

opt: option

cur: current

st: state

str: string

int: integer

ele: element

*/

// options, states, variables data map, element references

const eleOutput = document.getElementById('output'),
      eleInput = document.getElementById('input')

let stateMap = {

        1: {id: 'createChoose', type: 'opt', text: "Create or choose a character.", options: [1, 2]},
        2: {id: 'chooseCharacter', type: 'opt', text: "Choose your character.", options: []},
        3: {id: 'chooseAncestry', type: 'assign', text: "Choose your character's ancestry", arg: 'ancestry', next: 4},
        4: {id: 'nameCharacter', type: 'assign', text: "What will your character's name be?", arg: 'name', next: ''}

    }

let optMap = {

        1: {id: 'choose', text: "Choose.", next: 2},
        2: {id: 'create', text: "Create.", next: 3}
    
    }
        
let funcMap = {

    }

let assignMap = {
    
}

let character = {
    
    name: "default",
    ancestry: "default"

}

// prints current input state text and options if any

let stCur = stateMap['1']

function printSt() { 

    eleOutput.innerHTML += `${stCur.text}<br>`

    if (stCur.type === 'opt') {

        let i = 1

        for (x in stCur.options) {

            eleOutput.innerHTML += `<br>${i}. ${optMap[stCur.options[x]].text}`

            i++

        }

        eleOutput.innerHTML += "<br>"

}

    eleOutput.innerHTML += "<br>"

    eleOutput.scrollTop = eleOutput.scrollHeight

}

function assign(para1) {

    para1 = userInput

}

function validate(para1) {

    if (para1 === userInput) {

        return true

    }

    return false

}

//clears input field on enter key/assigns input/converts input

let userInput

eleInput.addEventListener('keyup', (event) => {

    if (event.key === 'Enter' & eleInput.value != '') {

        userInput = eleInput.value

        eleInput.value = ""

        if (! isNaN(userInput)) {

            userInput = parseInt(userInput)

        }
        
        //checks if the current input state is an options, string, or int type
        //and then prints the text of that input state

        switch (stCur.type) {

            case 'opt':

                let optChoice = optMap[stCur['options'][userInput-1]]

                if (isNaN(userInput)) {

                    break

                }

                if (optChoice.func) {

                    funcMap[optChoice.func]()

                }

                stCur = stateMap[optChoice.next]

                printSt()

                break

            case 'assign':

                assign(stCur.arg)

                stCur = stateMap[stCur.next]

                console.log(character['ancestry'])

                printSt()

                break
            
            case 'validate':

                if (isNaN(userInput)) {

                    if (funcMap[stCur.func]() === true) {

                        stCur = stateMap[stCur.next]

                        printSt()

                        break

                    }

                break

                }
        }
    }
})

let myGamePiece = new component(24, 24, "red", 0, 0)

let canvasFloor = document.getElementById("canvasFloor")
    canvasFloor.width = 120
    canvasFloor.height = 120

let canvasObjects = document.getElementById("canvasObjects")
    canvasObjects.width = 120
    canvasObjects.height = 120

let canvasPlayer = document.getElementById("canvasPlayer")
    canvasPlayer.width = 120
    canvasPlayer.height = 120

let contextFloor = canvasFloor.getContext("2d"),
    contextObjects = canvasObjects.getContext("2d"),
    contextPlayer = canvasPlayer.getContext("2d")

function component(width, height, color, x, y) {
    this.width = width
    this.height = height
    this.color = color
    this.x = x
    this.y = y
}

function updatePlayer() {
    contextPlayer.clearRect(0, 0, canvasPlayer.width, canvasPlayer.height)
    contextPlayer.fillStyle = myGamePiece.color
    contextPlayer.fillRect(myGamePiece.x, myGamePiece.y, myGamePiece.width, myGamePiece.height)
}

let mapFloorArray = [1,0,0,0,0,
                     0,1,0,0,0,
                     0,0,1,0,0,
                     0,1,0,0,0,
                     0,1,1,1,1],

    mapObjectsArray = [1,0,0,0,0,
                       0,1,0,0,0,
                       0,0,2,0,0,
                       0,1,0,0,0,
                       0,1,1,2,1],
    
    mapPlayerArray = [0,0,0,0,0,
                      0,0,0,0,0,
                      0,0,3,0,0,
                      0,0,0,0,0,
                      0,0,0,0,0]
                    

let mapData = {size: 25, width: 5, height: 5, tileWidth: 24, tileHeight: 24},
    xCoord = 0,
    yCoord = 0,
    tileIndex = 0

for (e in mapFloorArray) {
    tileIndex += 1

    if (mapFloorArray[e] == 1) {
        contextFloor.fillStyle = "grey"
        contextFloor.fillRect(xCoord, yCoord, 24, 24)
    }

    if (tileIndex == mapData['width']) {
        tileIndex = 0
        xCoord = 0
        yCoord += 24
        continue
    }

    xCoord += 24
}

xCoord = 0,
yCoord = 0,
tileIndex = 0

for (e in mapObjectsArray) {
    tileIndex += 1

    if (mapObjectsArray[e] == 2) {
        contextObjects.fillStyle = "blue"
        contextObjects.fillRect(xCoord, yCoord, 24, 24)
    }

    if (tileIndex == mapData['width']) {
        tileIndex = 0
        xCoord = 0
        yCoord += 24
        continue
    }

    xCoord += 24
}

xCoord = 0,
yCoord = 0,
tileIndex = 0

for (e in mapPlayerArray) {
    tileIndex += 1

    if (mapPlayerArray[e] == 3) {
        myGamePiece.x = xCoord
        myGamePiece.y = yCoord
        contextPlayer.fillStyle = "blue"
        contextPlayer.fillRect(xCoord, yCoord, 24, 24)
    }

    if (tileIndex == mapData['width']) {
        tileIndex = 0
        xCoord = 0
        yCoord += 24
        continue
    }

    xCoord += 24
}

let interval = setInterval(updatePlayer, 200)

function moveNorth() {
    if (myGamePiece.y > 0) {
        myGamePiece.y -= 24
    }
}

function moveNorthEast() {
    if (myGamePiece.y > 0) {
        myGamePiece.x += 24
        myGamePiece.y -= 24
    }
}

function moveNorthWest() {
    if (myGamePiece.y > 0) {
        myGamePiece.x -= 24
        myGamePiece.y -= 24
    }
}

function moveEast() {
    if (myGamePiece.x < 96) {
        myGamePiece.x += 24
    }
}

function moveSouth() {
    if (myGamePiece.y < 96) {
        myGamePiece.y += 24
    }
}

function moveSouthEast() {
    if (myGamePiece.y < 96) {
        myGamePiece.x += 24
        myGamePiece.y += 24
    }
}

function moveSouthWest() {
    if (myGamePiece.y < 96) {
        myGamePiece.x -= 24
        myGamePiece.y += 24
    }
}

function moveWest() {
    if (myGamePiece.x > 0) {
        myGamePiece.x -= 24
    }
}

document.addEventListener('keyup', function(event) {

    if (event.keyCode == 87) {
        moveNorth()
    }
    
    else if (event.keyCode == 69) {
        moveNorthEast()
    }

    else if (event.keyCode == 81) {
        moveNorthWest()
    }

    else if (event.keyCode == 68) {
        moveEast()
    }

    else if (event.keyCode == 88) {
        moveSouth()
    }

    else if (event.keyCode == 67) {
        moveSouthEast()
    }

    else if (event.keyCode == 90) {
        moveSouthWest()
    }

    else if (event.keyCode == 65) {
        moveWest()
    }
})

printSt()

</script>

</body>

</html>